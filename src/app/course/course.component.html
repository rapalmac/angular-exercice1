<section class="container">
    <form [formGroup]="formGroup" #courseForm="ngForm" class="fx-column fx-center" (ngSubmit)="onSaveForm()">
        <h2>Courses</h2>
        <mat-form-field>
            <mat-label>Code:</mat-label>
            <input matInput type="text" id="courseCode" name="courseCode" formControlName="code">

            <mat-error *ngIf="formGroup.get('code').hasError('required')">The code is required.</mat-error>
            <mat-error *ngIf="formGroup.get('code').hasError('duplicated')">The code '{{formGroup.get('code').value}}' is duplicated.</mat-error>
            <mat-error *ngIf="formGroup.get('code').hasError('minlength')">The code should be at least 4 caracters.</mat-error>
        </mat-form-field>
        
        <mat-form-field>
                <mat-label>Name:</mat-label>
                <input matInput type="text" id="courseName" name="courseName" formControlName="name">

                <mat-error *ngIf="formGroup.get('name').hasError('required')">The name is required.</mat-error>
                <mat-error *ngIf="formGroup.get('name').hasError('minlength')">The name should be at least 4 caracters.</mat-error>
        </mat-form-field>

        <mat-form-field>
                <mat-label>Description:</mat-label>
                <input matInput type="text" name="courseDescription" formControlName="description">
        </mat-form-field>

        <mat-form-field>
            <mat-label>Level:</mat-label>
            <mat-select name="courseLevel" formControlName="level">
                <mat-option value="BEGGINER">Beginner</mat-option>
                <mat-option value="INTERMEDIATE">Intermediate</mat-option>
                <mat-option value="ADVANCED">Advanced</mat-option>
            </mat-select>

            <mat-error *ngIf="formGroup.get('name').hasError('required')">The level is required.</mat-error>
        </mat-form-field>

        <div class="fx-row fx-right">
            <button mat-raised-button color="primary" type="submit" 
                [disabled]="selection.isSelected() || !formGroup.valid">Save</button>
            <button mat-raised-button color="primary" type="button" 
                [disabled]="!selection.isSelected() || !formGroup.valid"
                (click)="onUpdateForm()">Update</button>
            <button mat-raised-button type="button" (click)="onResetForm()">Reset</button>
        </div>
    </form>

    <table mat-table #dataTable [dataSource]="dataSource">
        <ng-container matColumnDef="select">
            <th mat-header-cell *matHeaderCellDef> Select </th>
            <td mat-cell *matCellDef="let course">
              <mat-checkbox (click)="$event.stopPropagation()"
                            (change)="$event ? onSelectRow(course) : null"
                            [checked]="tableSelection.isSelected(course)">
              </mat-checkbox>
            </td>
          </ng-container>

        <ng-container matColumnDef="code">
            <th mat-header-cell *matHeaderCellDef> Code </th>
            <td mat-cell *matCellDef="let course"> {{course.code}} </td>
        </ng-container>

        <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef> Name </th>
            <td mat-cell *matCellDef="let course"> {{course.name}} </td>
        </ng-container>

        <ng-container matColumnDef="level">
            <th mat-header-cell *matHeaderCellDef> Level </th>
            <td mat-cell *matCellDef="let course"> {{course.level}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
        <tr mat-row *matRowDef="let myRowData; columns: columnsToDisplay"></tr>
    </table>
</section>
